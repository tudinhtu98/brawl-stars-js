<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple 2.5D Brawl Stars Game</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #98d687;
            font-family: Arial, sans-serif;
        }
        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
        #player {
            position: absolute;
            width: 60px;
            height: 80px;
            transform-origin: bottom center;
            transform: perspective(600px) rotateX(30deg);
            transition: transform 0.1s;
        }
        .player-body {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: #f44336;
            border-radius: 50%;
            bottom: 0;
            left: 5px;
        }
        .player-head {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #ffccbc;
            border-radius: 50%;
            bottom: 35px;
            left: 15px;
        }
        .projectile {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #ff9800;
            border-radius: 50%;
            transform: perspective(600px) rotateX(30deg);
        }
        .enemy {
            position: absolute;
            width: 60px;
            height: 80px;
            transform: perspective(600px) rotateX(30deg);
        }
        .enemy-body {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: #3f51b5;
            border-radius: 50%;
            bottom: 0;
            left: 5px;
        }
        .enemy-head {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #c5cae9;
            border-radius: 50%;
            bottom: 35px;
            left: 15px;
        }
        .shadow {
            position: absolute;
            width: 40px;
            height: 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            bottom: -5px;
            left: 10px;
        }
        .bush {
            position: absolute;
            width: 120px;
            height: 80px;
            background-color: #4caf50;
            border-radius: 60px;
            transform: perspective(600px) rotateX(30deg);
        }
        .box {
            position: absolute;
            width: 60px;
            height: 60px;
            background-color: #8d6e63;
            transform: perspective(600px) rotateX(30deg);
        }
        .health-bar {
            position: absolute;
            width: 60px;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            bottom: -15px;
            overflow: hidden;
        }
        .health-fill {
            height: 100%;
            background-color: #4caf50;
            width: 100%;
        }
        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        #controls {
            position: absolute;
            bottom: 20px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 30px;
            box-sizing: border-box;
        }
        .joystick {
            width: 120px;
            height: 120px;
            background-color: rgba(255,255,255,0.3);
            border-radius: 50%;
            position: relative;
        }
        .joystick-knob {
            width: 60px;
            height: 60px;
            background-color: rgba(255,255,255,0.6);
            border-radius: 50%;
            position: absolute;
            top: 30px;
            left: 30px;
        }
        .action-button {
            width: 80px;
            height: 80px;
            background-color: rgba(255,0,0,0.6);
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="score">Score: 0</div>
        <div id="player">
            <div class="shadow"></div>
            <div class="player-body"></div>
            <div class="player-head"></div>
            <div class="health-bar"><div class="health-fill"></div></div>
        </div>
        <div id="controls">
            <div class="joystick">
                <div class="joystick-knob"></div>
            </div>
            <div class="action-button"></div>
        </div>
    </div>

    <script>
        // Game variables
        const player = document.getElementById('player');
        const gameContainer = document.getElementById('game-container');
        const scoreDisplay = document.getElementById('score');
        const joystick = document.querySelector('.joystick');
        const joystickKnob = document.querySelector('.joystick-knob');
        const actionButton = document.querySelector('.action-button');
        
        let playerX = window.innerWidth / 2;
        let playerY = window.innerHeight / 2;
        let playerSpeed = 5;
        let playerHealth = 100;
        let playerScore = 0;
        let projectiles = [];
        let enemies = [];
        let bushes = [];
        let boxes = [];
        let joystickActive = false;
        let joystickAngle = 0;
        let joystickDistance = 0;
        let joystickCenterX = 0;
        let joystickCenterY = 0;
        
        // Initialize game
        function initGame() {
            updatePlayerPosition();
            
            // Create some bushes
            for (let i = 0; i < 10; i++) {
                createBush();
            }
            
            // Create some boxes
            for (let i = 0; i < 8; i++) {
                createBox();
            }
            
            // Add enemies every few seconds
            setInterval(createEnemy, 3000);
            
            // Start game loop
            gameLoop();
        }
        
        // Game loop
        function gameLoop() {
            movePlayer();
            moveProjectiles();
            moveEnemies();
            checkCollisions();
            requestAnimationFrame(gameLoop);
        }
        
        // Update player position
        function updatePlayerPosition() {
            player.style.left = (playerX - 30) + 'px';
            player.style.top = (playerY - 40) + 'px';
        }
        
        // Move player based on joystick
        function movePlayer() {
            if (joystickActive && joystickDistance > 10) {
                const moveX = Math.cos(joystickAngle) * playerSpeed * (joystickDistance / 30);
                const moveY = Math.sin(joystickAngle) * playerSpeed * (joystickDistance / 30);
                
                playerX += moveX;
                playerY += moveY;
                
                // Keep player inside boundaries
                playerX = Math.max(50, Math.min(window.innerWidth - 50, playerX));
                playerY = Math.max(50, Math.min(window.innerHeight - 50, playerY));
                
                updatePlayerPosition();
                
                // Rotate player to face movement direction
                const rotationAngle = (joystickAngle * 180 / Math.PI) + 90;
                player.style.transform = `perspective(600px) rotateX(30deg) rotateZ(${rotationAngle}deg)`;
            }
        }
        
        // Create a projectile
        function createProjectile() {
            const projectile = document.createElement('div');
            projectile.className = 'projectile';
            
            // Start from player position
            const projectileX = playerX;
            const projectileY = playerY;
            
            // Set direction based on player rotation
            const direction = joystickAngle;
            const speed = 10;
            
            // Add to the game
            gameContainer.appendChild(projectile);
            
            // Add to projectiles array
            projectiles.push({
                element: projectile,
                x: projectileX,
                y: projectileY,
                direction: direction,
                speed: speed
            });
        }
        
        // Move projectiles
        function moveProjectiles() {
            for (let i = projectiles.length - 1; i >= 0; i--) {
                const projectile = projectiles[i];
                
                projectile.x += Math.cos(projectile.direction) * projectile.speed;
                projectile.y += Math.sin(projectile.direction) * projectile.speed;
                
                projectile.element.style.left = (projectile.x - 10) + 'px';
                projectile.element.style.top = (projectile.y - 10) + 'px';
                
                // Remove if out of bounds
                if (projectile.x < 0 || projectile.x > window.innerWidth || 
                    projectile.y < 0 || projectile.y > window.innerHeight) {
                    gameContainer.removeChild(projectile.element);
                    projectiles.splice(i, 1);
                }
            }
        }
        
        // Create an enemy
        function createEnemy() {
            const enemy = document.createElement('div');
            enemy.className = 'enemy';
            
            const enemyBody = document.createElement('div');
            enemyBody.className = 'enemy-body';
            
            const enemyHead = document.createElement('div');
            enemyHead.className = 'enemy-head';
            
            const shadow = document.createElement('div');
            shadow.className = 'shadow';
            
            const healthBar = document.createElement('div');
            healthBar.className = 'health-bar';
            
            const healthFill = document.createElement('div');
            healthFill.className = 'health-fill';
            
            healthBar.appendChild(healthFill);
            enemy.appendChild(shadow);
            enemy.appendChild(enemyBody);
            enemy.appendChild(enemyHead);
            enemy.appendChild(healthBar);
            
            // Random position at the edge of the screen
            let enemyX, enemyY;
            if (Math.random() < 0.5) {
                enemyX = Math.random() < 0.5 ? 0 : window.innerWidth;
                enemyY = Math.random() * window.innerHeight;
            } else {
                enemyX = Math.random() * window.innerWidth;
                enemyY = Math.random() < 0.5 ? 0 : window.innerHeight;
            }
            
            gameContainer.appendChild(enemy);
            
            // Add to enemies array
            enemies.push({
                element: enemy,
                healthBar: healthFill,
                x: enemyX,
                y: enemyY,
                speed: 1 + Math.random() * 2,
                health: 100
            });
        }
        
        // Move enemies
        function moveEnemies() {
            for (let i = 0; i < enemies.length; i++) {
                const enemy = enemies[i];
                
                // Move towards player
                const dx = playerX - enemy.x;
                const dy = playerY - enemy.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > 10) {
                    enemy.x += (dx / distance) * enemy.speed;
                    enemy.y += (dy / distance) * enemy.speed;
                    
                    // Rotate to face player
                    const angle = Math.atan2(dy, dx);
                    const rotationAngle = (angle * 180 / Math.PI) + 90;
                    enemy.element.style.transform = `perspective(600px) rotateX(30deg) rotateZ(${rotationAngle}deg)`;
                }
                
                enemy.element.style.left = (enemy.x - 30) + 'px';
                enemy.element.style.top = (enemy.y - 40) + 'px';
            }
        }
        
        // Create a bush
        function createBush() {
            const bush = document.createElement('div');
            bush.className = 'bush';
            
            // Random position
            const bushX = Math.random() * (window.innerWidth - 200) + 100;
            const bushY = Math.random() * (window.innerHeight - 200) + 100;
            
            bush.style.left = (bushX - 60) + 'px';
            bush.style.top = (bushY - 40) + 'px';
            
            gameContainer.appendChild(bush);
            
            // Add to bushes array
            bushes.push({
                element: bush,
                x: bushX,
                y: bushY
            });
        }
        
        // Create a box
        function createBox() {
            const box = document.createElement('div');
            box.className = 'box';
            
            // Random position
            const boxX = Math.random() * (window.innerWidth - 200) + 100;
            const boxY = Math.random() * (window.innerHeight - 200) + 100;
            
            box.style.left = (boxX - 30) + 'px';
            box.style.top = (boxY - 30) + 'px';
            
            gameContainer.appendChild(box);
            
            // Add to boxes array
            boxes.push({
                element: box,
                x: boxX,
                y: boxY,
                health: 100
            });
        }
        
        // Check collisions
        function checkCollisions() {
            // Projectiles vs enemies
            for (let i = projectiles.length - 1; i >= 0; i--) {
                const projectile = projectiles[i];
                
                for (let j = enemies.length - 1; j >= 0; j--) {
                    const enemy = enemies[j];
                    
                    const dx = projectile.x - enemy.x;
                    const dy = projectile.y - enemy.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < 40) {
                        // Hit enemy
                        enemy.health -= 20;
                        enemy.healthBar.style.width = enemy.health + '%';
                        
                        // Remove projectile
                        gameContainer.removeChild(projectile.element);
                        projectiles.splice(i, 1);
                        
                        if (enemy.health <= 0) {
                            // Enemy killed
                            gameContainer.removeChild(enemy.element);
                            enemies.splice(j, 1);
                            
                            // Increase score
                            playerScore += 10;
                            scoreDisplay.textContent = 'Score: ' + playerScore;
                        }
                        
                        break;
                    }
                }
            }
            
            // Player vs enemies
            for (let i = enemies.length - 1; i >= 0; i--) {
                const enemy = enemies[i];
                
                const dx = playerX - enemy.x;
                const dy = playerY - enemy.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 50) {
                    // Hit player
                    playerHealth -= 0.2;
                    player.querySelector('.health-fill').style.width = playerHealth + '%';
                    
                    if (playerHealth <= 0) {
                        // Game over
                        alert('Game Over! Your score: ' + playerScore);
                        resetGame();
                    }
                }
            }
        }
        
        // Reset game
        function resetGame() {
            playerX = window.innerWidth / 2;
            playerY = window.innerHeight / 2;
            playerHealth = 100;
            playerScore = 0;
            scoreDisplay.textContent = 'Score: 0';
            player.querySelector('.health-fill').style.width = '100%';
            
            // Remove all enemies and projectiles
            for (const enemy of enemies) {
                gameContainer.removeChild(enemy.element);
            }
            enemies = [];
            
            for (const projectile of projectiles) {
                gameContainer.removeChild(projectile.element);
            }
            projectiles = [];
            
            updatePlayerPosition();
        }
        
        // Joystick controls
        joystick.addEventListener('touchstart', handleJoystickStart);
        joystick.addEventListener('touchmove', handleJoystickMove);
        joystick.addEventListener('touchend', handleJoystickEnd);
        
        // Mouse controls for testing on desktop
        joystick.addEventListener('mousedown', handleJoystickStart);
        window.addEventListener('mousemove', handleJoystickMove);
        window.addEventListener('mouseup', handleJoystickEnd);
        
        function handleJoystickStart(e) {
            joystickActive = true;
            joystickCenterX = joystick.getBoundingClientRect().left + 60;
            joystickCenterY = joystick.getBoundingClientRect().top + 60;
        }
        
        function handleJoystickMove(e) {
            if (!joystickActive) return;
            
            let clientX, clientY;
            if (e.type === 'touchmove') {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }
            
            const dx = clientX - joystickCenterX;
            const dy = clientY - joystickCenterY;
            joystickDistance = Math.min(50, Math.sqrt(dx * dx + dy * dy));
            joystickAngle = Math.atan2(dy, dx);
            
            const moveX = Math.cos(joystickAngle) * joystickDistance;
            const moveY = Math.sin(joystickAngle) * joystickDistance;
            
            joystickKnob.style.transform = `translate(${moveX}px, ${moveY}px)`;
        }
        
        function handleJoystickEnd() {
            joystickActive = false;
            joystickKnob.style.transform = 'translate(0, 0)';
        }
        
        // Fire button
        actionButton.addEventListener('touchstart', createProjectile);
        actionButton.addEventListener('mousedown', createProjectile);
        
        // Handle window resize
        window.addEventListener('resize', function() {
            // Adjust positions if needed
            playerX = Math.min(playerX, window.innerWidth - 50);
            playerY = Math.min(playerY, window.innerHeight - 50);
            updatePlayerPosition();
        });
        
        // Start the game
        initGame();
    </script>
</body>
</html>
